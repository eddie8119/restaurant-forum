{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport AdminRestaurantForm from \"./../components/AdminRestaurantForm.vue\";\nimport adminAPI from './../apis/admin';\nimport { Toast } from './../utils/helpers';\nexport default {\n  name: \"AdminRestaurantEdit\",\n  components: {\n    AdminRestaurantForm\n  },\n\n  data() {\n    return {\n      restaurant: {\n        id: -1,\n        name: \"\",\n        categoryId: \"\",\n        tel: \"\",\n        address: \"\",\n        description: \"\",\n        image: \"\",\n        openingHours: \"\"\n      },\n      isProcessing: false\n    };\n  },\n\n  created() {\n    const {\n      id\n    } = this.$route.params;\n    this.fetchRestaurant(id);\n  },\n\n  // beforeRouteUpdate(to, from, next){\n  //   const {id} = to.params\n  //   this.fetchRestaurant(id);\n  //   next()\n  // },\n  methods: {\n    async fetchRestaurant(restaurantId) {\n      try {\n        const response = await adminAPI.restaurants.getDetail({\n          restaurantId\n        });\n\n        if (response.statusText !== \"OK\") {\n          throw new Error(\"無法編輯餐廳資料，請稍後再試\");\n        }\n\n        const {\n          id,\n          name,\n          tel,\n          address,\n          opening_hours: openingHours,\n          description,\n          image,\n          CategoryId: categoryId\n        } = response.data.restaurant;\n        this.restaurant = { ...this.restaurant,\n          id,\n          name,\n          categoryId,\n          tel,\n          address,\n          description,\n          image,\n          openingHours\n        };\n      } catch (error) {\n        this.isProcessing = false;\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得餐廳資料，請稍後再試'\n        });\n      }\n    },\n\n    // async handleAfterSubmit(formData) {\n    //   try {\n    //     this.isProcessing = true\n    //     const { data } = await adminAPI.restaurants.update({\n    //       restaurantId: this.restaurant.id,\n    //       formData\n    //     })\n    //     if (data.status !== 'success') {\n    //       throw new Error(data.message)\n    //     }\n    //     this.$router.push({ name: 'admin-restaurants' })\n    //   } catch (error) {\n    //     this.isProcessing = false\n    //     Toast.fire({\n    //       icon: 'error',\n    //       title: '無法更新餐廳資料，請稍後再試'\n    //     })\n    //   }      \n    // }, \n    async handleAfterSubmit(formData) {\n      try {\n        this.isProcessing = true;\n        const {\n          data\n        } = await adminAPI.restaurants.update({\n          restaurantId: this.restaurant.id,\n          formData\n        });\n\n        if (data.status === 'error') {\n          throw new Error(data.message);\n        }\n\n        this.$router.push({\n          name: 'admin-restaurants'\n        });\n      } catch (error) {\n        this.isProcessing = false;\n        Toast.fire({\n          icon: 'error',\n          title: '無法更新餐廳資料，請稍後再試'\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";AAWA;AACA;AACA;AAEA;EACAA,2BADA;EAEAC;IACAC;EADA,CAFA;;EAKAC;IACA;MACAC;QACAC,MADA;QAEAL,QAFA;QAGAM,cAHA;QAIAC,OAJA;QAKAC,WALA;QAMAC,eANA;QAOAC,SAPA;QAQAC;MARA,CADA;MAWAC;IAXA;EAaA,CAnBA;;EAoBAC;IACA;MAAAR;IAAA;IACA;EAEA,CAxBA;;EAyBA;EACA;EACA;EACA;EACA;EACAS;IACA;MACA;QACA;UAAAC;QAAA;;QAEA;UACA;QACA;;QAEA;UACAV,EADA;UAEAL,IAFA;UAGAO,GAHA;UAIAC,OAJA;UAKAQ,2BALA;UAMAP,WANA;UAOAC,KAPA;UAQAO;QARA,IASAC,wBATA;QAWA,oBACA,kBADA;UAEAb,EAFA;UAGAL,IAHA;UAIAM,UAJA;UAKAC,GALA;UAMAC,OANA;UAOAC,WAPA;UAQAC,KARA;UASAC;QATA;MAWA,CA7BA,CA6BA;QACA;QACAQ;UACAC,aADA;UAEAC;QAFA;MAIA;IACA,CAtCA;;IAwCA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;MACA;QACA;QACA;UAAAlB;QAAA;UACAY,gCADA;UAEAO;QAFA;;QAKA;UACA;QACA;;QAEA;UAAAtB;QAAA;MAEA,CAbA,CAaA;QACA;QACAmB;UACAC,aADA;UAEAC;QAFA;MAIA;IACA;;EAlFA;AA9BA","names":["name","components","AdminRestaurantForm","data","restaurant","id","categoryId","tel","address","description","image","openingHours","isProcessing","created","methods","restaurantId","opening_hours","CategoryId","response","Toast","icon","title","formData"],"sourceRoot":"src/views","sources":["AdminRestaurantEdit.vue"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <AdminRestaurantForm\r\n      :initial-restaurant=\"restaurant\"\r\n      :is-processing=\"isProcessing\"\r\n      @after-submit=\"handleAfterSubmit\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AdminRestaurantForm from \"./../components/AdminRestaurantForm.vue\";\r\nimport adminAPI from './../apis/admin'\r\nimport { Toast } from './../utils/helpers'\r\n\r\nexport default {\r\n  name: \"AdminRestaurantEdit\",\r\n  components: {\r\n    AdminRestaurantForm,\r\n  },\r\n  data() {\r\n    return {\r\n      restaurant: {\r\n        id: -1,\r\n        name: \"\",\r\n        categoryId: \"\",\r\n        tel: \"\",\r\n        address: \"\",\r\n        description: \"\",\r\n        image: \"\",\r\n        openingHours: \"\",\r\n      },\r\n      isProcessing: false\r\n    };\r\n  },\r\n  created() {\r\n    const { id } = this.$route.params;\r\n    this.fetchRestaurant(id);\r\n    \r\n  },\r\n  // beforeRouteUpdate(to, from, next){\r\n  //   const {id} = to.params\r\n  //   this.fetchRestaurant(id);\r\n  //   next()\r\n  // },\r\n  methods: {\r\n    async fetchRestaurant (restaurantId) {\r\n      try {\r\n        const response = await adminAPI.restaurants.getDetail({restaurantId})\r\n\r\n        if (response.statusText !== \"OK\") {\r\n          throw new Error(\"無法編輯餐廳資料，請稍後再試\");\r\n        }\r\n\r\n        const {\r\n          id,\r\n          name,\r\n          tel,\r\n          address,\r\n          opening_hours: openingHours,\r\n          description,\r\n          image,\r\n          CategoryId: categoryId\r\n        } = response.data.restaurant\r\n\r\n        this.restaurant = {\r\n          ...this.restaurant,\r\n          id,\r\n          name,\r\n          categoryId,\r\n          tel,\r\n          address,\r\n          description,\r\n          image,\r\n          openingHours\r\n        }\r\n      } catch(error) {\r\n        this.isProcessing = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得餐廳資料，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n\r\n    // async handleAfterSubmit(formData) {\r\n    //   try {\r\n    //     this.isProcessing = true\r\n    //     const { data } = await adminAPI.restaurants.update({\r\n    //       restaurantId: this.restaurant.id,\r\n    //       formData\r\n    //     })\r\n\r\n    //     if (data.status !== 'success') {\r\n    //       throw new Error(data.message)\r\n    //     }\r\n\r\n    //     this.$router.push({ name: 'admin-restaurants' })\r\n    //   } catch (error) {\r\n    //     this.isProcessing = false\r\n    //     Toast.fire({\r\n    //       icon: 'error',\r\n    //       title: '無法更新餐廳資料，請稍後再試'\r\n    //     })\r\n    //   }      \r\n    // }, \r\n    async handleAfterSubmit (formData) {\r\n      try {\r\n        this.isProcessing = true\r\n        const {data} = await adminAPI.restaurants.update({\r\n          restaurantId: this.restaurant.id,\r\n          formData\r\n        })\r\n\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }\r\n\r\n        this.$router.push({ name: 'admin-restaurants' })\r\n\r\n      } catch(error) {\r\n        this.isProcessing = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法更新餐廳資料，請稍後再試'\r\n        })\r\n      }\r\n    }   \r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}