{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport SignIn from \"../views/SignIn.vue\";\nimport NotFound from \"../views/NotFound.vue\";\nimport RestaurantS from \"../views/RestaurantS.vue\";\nimport store from \"./../store\";\nVue.use(VueRouter);\n\nconst authorizeIsAdmin = (to, from, next) => {\n  const currentUser = store.state.currentUser;\n\n  if (currentUser && !currentUser.isAdmin) {\n    next('/404');\n    return;\n  }\n\n  next();\n};\n\nconst router = new VueRouter({\n  linkExactActiveClass: \"active\",\n  routes: [{\n    path: \"/\",\n    name: \"root\",\n    redirect: \"/restaurants\"\n  }, {\n    path: \"/admin\",\n    exact: true,\n    redirect: \"/admin/restaurants\"\n  }, {\n    path: \"/admin/categories\",\n    name: \"admin-categories\",\n    component: () => import(\"../views/AdminCategories.vue\")\n  }, {\n    path: \"/admin/restaurants\",\n    name: \"admin-restaurants\",\n    component: () => import(\"../views/AdminRestaurants.vue\"),\n    beforeEnter: authorizeIsAdmin\n  }, {\n    path: \"/admin/restaurants/new\",\n    name: \"admin-restaurant-new\",\n    component: () => import(\"../views/AdminRestaurantNew.vue\"),\n    beforeEnter: authorizeIsAdmin\n  }, {\n    path: \"/admin/restaurants/:id/edit\",\n    name: \"admin-restaurant-edit\",\n    component: () => import(\"../views/AdminRestaurantEdit.vue\")\n  }, {\n    path: \"/admin/restaurants/:id\",\n    name: \"admin-restaurant\",\n    component: () => import(\"../views/AdminRestaurant.vue\")\n  }, {\n    path: \"/signin\",\n    name: \"sign-in\",\n    component: SignIn\n  }, {\n    path: \"/signup\",\n    name: \"sign-up\",\n    component: () => import(\"../views/SignUp.vue\")\n  }, {\n    path: \"/restaurants\",\n    name: \"restaurants\",\n    component: RestaurantS\n  }, {\n    path: \"/restaurants/feeds\",\n    name: \"restaurants-feeds\",\n    component: () => import(\"../views/RestaurantsFeeds.vue\")\n  }, {\n    path: \"/restaurants/top\",\n    name: \"restaurants-tops\",\n    component: () => import(\"../views/RestaurantsTop.vue\")\n  }, {\n    path: \"/restaurants/:id\",\n    name: \"restaurant\",\n    component: () => import(\"../views/RestauranT.vue\")\n  }, {\n    path: \"/restaurants/:id/dashboard\",\n    name: \"dashboard\",\n    component: () => import(\"../views/RestaurantDashboard.vue\")\n  }, {\n    path: \"/user\",\n    name: \"user\",\n    component: () => import(\"../views/UseR.vue\")\n  }, {\n    path: \"/users/top\",\n    name: \"users-top\",\n    component: () => import(\"../views/UsersTop.vue\")\n  }, {\n    path: \"/user/:id/edit\",\n    name: \"user-edit\",\n    component: () => import(\"../views/UserEdit.vue\")\n  }, {\n    path: \"*\",\n    name: \"not-found\",\n    component: NotFound\n  }]\n});\nrouter.beforeEach(async (to, from, next) => {\n  const tokenInLocalStorage = localStorage.getItem('token');\n  const tokenInStore = store.state.token;\n  let isAuthenticated = store.state.isAuthenticated;\n\n  if (tokenInLocalStorage && tokenInLocalStorage !== tokenInStore) {\n    isAuthenticated = await store.dispatch('fetchCurrentUser');\n  }\n\n  const pathsWithoutAuthentication = ['sign-up', 'sign-in'];\n\n  if (!isAuthenticated && !pathsWithoutAuthentication.includes(to.name)) {\n    next('/signin');\n    return;\n  }\n\n  if (isAuthenticated && pathsWithoutAuthentication.includes(to.name)) {\n    next('/restaurants');\n    return;\n  }\n\n  next();\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","SignIn","NotFound","RestaurantS","store","use","authorizeIsAdmin","to","from","next","currentUser","state","isAdmin","router","linkExactActiveClass","routes","path","name","redirect","exact","component","beforeEnter","beforeEach","tokenInLocalStorage","localStorage","getItem","tokenInStore","token","isAuthenticated","dispatch","pathsWithoutAuthentication","includes"],"sources":["C:/Users/WING JING/Desktop/ac/3/restaurant-vue/src/router/index.js"],"sourcesContent":["import Vue from \"vue\";\r\nimport VueRouter from \"vue-router\";\r\nimport SignIn from \"../views/SignIn.vue\";\r\nimport NotFound from \"../views/NotFound.vue\";\r\nimport RestaurantS from \"../views/RestaurantS.vue\";\r\nimport store from \"./../store\"\r\n\r\nVue.use(VueRouter);\r\n\r\nconst authorizeIsAdmin = (to, from, next) => {\r\n  const currentUser = store.state.currentUser\r\n  if (currentUser && !currentUser.isAdmin) {\r\n    next('/404')\r\n    return\r\n  }\r\n\r\n  next()\r\n}\r\n\r\nconst router = new VueRouter({\r\n  linkExactActiveClass: \"active\",\r\n  routes: [\r\n    {\r\n      path: \"/\",\r\n      name: \"root\",\r\n      redirect: \"/restaurants\",\r\n    },\r\n    {\r\n      path: \"/admin\",\r\n      exact: true,\r\n      redirect: \"/admin/restaurants\",\r\n    },\r\n    {\r\n      path: \"/admin/categories\",\r\n      name: \"admin-categories\",\r\n      component: () => import(\"../views/AdminCategories.vue\"),\r\n    },\r\n    {\r\n      path: \"/admin/restaurants\",\r\n      name: \"admin-restaurants\",\r\n      component: () => import(\"../views/AdminRestaurants.vue\"),\r\n      beforeEnter: authorizeIsAdmin\r\n    },\r\n    {\r\n      path: \"/admin/restaurants/new\",\r\n      name: \"admin-restaurant-new\",\r\n      component: () => import(\"../views/AdminRestaurantNew.vue\"),\r\n      beforeEnter: authorizeIsAdmin\r\n    },\r\n    {\r\n      path: \"/admin/restaurants/:id/edit\",\r\n      name: \"admin-restaurant-edit\",\r\n      component: () => import(\"../views/AdminRestaurantEdit.vue\"),\r\n      },\r\n    {\r\n      path: \"/admin/restaurants/:id\",\r\n      name: \"admin-restaurant\",\r\n      component: () => import(\"../views/AdminRestaurant.vue\"),\r\n    },\r\n    {\r\n      path: \"/signin\",\r\n      name: \"sign-in\",\r\n      component: SignIn,\r\n    },\r\n    {\r\n      path: \"/signup\",\r\n      name: \"sign-up\",\r\n      component: () => import(\"../views/SignUp.vue\"),\r\n    },\r\n    {\r\n      path: \"/restaurants\",\r\n      name: \"restaurants\",\r\n      component: RestaurantS,\r\n    },\r\n    {\r\n      path: \"/restaurants/feeds\",\r\n      name: \"restaurants-feeds\",\r\n      component: () => import(\"../views/RestaurantsFeeds.vue\"),\r\n    },\r\n    {\r\n      path: \"/restaurants/top\",\r\n      name: \"restaurants-tops\",\r\n      component: () => import(\"../views/RestaurantsTop.vue\"),\r\n    },\r\n    {\r\n      path: \"/restaurants/:id\",\r\n      name: \"restaurant\",\r\n      component: () => import(\"../views/RestauranT.vue\"),\r\n    },\r\n    {\r\n      path: \"/restaurants/:id/dashboard\",\r\n      name: \"dashboard\",\r\n      component: () => import(\"../views/RestaurantDashboard.vue\"),\r\n    },    \r\n    {\r\n      path: \"/user\",\r\n      name: \"user\",\r\n      component: () => import(\"../views/UseR.vue\"),\r\n    },\r\n    {\r\n      path: \"/users/top\",\r\n      name: \"users-top\",\r\n      component: () => import(\"../views/UsersTop.vue\"),\r\n    },\r\n    {\r\n      path: \"/user/:id/edit\",\r\n      name: \"user-edit\",\r\n      component: () => import(\"../views/UserEdit.vue\"),\r\n    },\r\n    {\r\n      path: \"*\",\r\n      name: \"not-found\",\r\n      component: NotFound,\r\n    },\r\n  ] \r\n});\r\n\r\nrouter.beforeEach(async(to, from, next) => {  \r\n  const tokenInLocalStorage = localStorage.getItem('token')\r\n  const tokenInStore = store.state.token\r\n  let isAuthenticated = store.state.isAuthenticated\r\n  \r\n  if(tokenInLocalStorage && tokenInLocalStorage !== tokenInStore) {\r\n    isAuthenticated = await store.dispatch('fetchCurrentUser')\r\n  }\r\n\r\n  const pathsWithoutAuthentication = ['sign-up', 'sign-in']\r\n\r\n  if (!isAuthenticated  && !pathsWithoutAuthentication.includes(to.name)) {\r\n    next('/signin')\r\n    return\r\n  }\r\n\r\n  if (isAuthenticated  && pathsWithoutAuthentication.includes(to.name)) {\r\n    next('/restaurants')\r\n    return\r\n  }\r\n  \r\n  next()\r\n})\r\n\r\nexport default router;\r\n"],"mappings":";AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,KAAP,MAAkB,YAAlB;AAEAL,GAAG,CAACM,GAAJ,CAAQL,SAAR;;AAEA,MAAMM,gBAAgB,GAAG,CAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,KAAoB;EAC3C,MAAMC,WAAW,GAAGN,KAAK,CAACO,KAAN,CAAYD,WAAhC;;EACA,IAAIA,WAAW,IAAI,CAACA,WAAW,CAACE,OAAhC,EAAyC;IACvCH,IAAI,CAAC,MAAD,CAAJ;IACA;EACD;;EAEDA,IAAI;AACL,CARD;;AAUA,MAAMI,MAAM,GAAG,IAAIb,SAAJ,CAAc;EAC3Bc,oBAAoB,EAAE,QADK;EAE3BC,MAAM,EAAE,CACN;IACEC,IAAI,EAAE,GADR;IAEEC,IAAI,EAAE,MAFR;IAGEC,QAAQ,EAAE;EAHZ,CADM,EAMN;IACEF,IAAI,EAAE,QADR;IAEEG,KAAK,EAAE,IAFT;IAGED,QAAQ,EAAE;EAHZ,CANM,EAWN;IACEF,IAAI,EAAE,mBADR;IAEEC,IAAI,EAAE,kBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,8BAAP;EAHnB,CAXM,EAgBN;IACEJ,IAAI,EAAE,oBADR;IAEEC,IAAI,EAAE,mBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,+BAAP,CAHnB;IAIEC,WAAW,EAAEf;EAJf,CAhBM,EAsBN;IACEU,IAAI,EAAE,wBADR;IAEEC,IAAI,EAAE,sBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,iCAAP,CAHnB;IAIEC,WAAW,EAAEf;EAJf,CAtBM,EA4BN;IACEU,IAAI,EAAE,6BADR;IAEEC,IAAI,EAAE,uBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,kCAAP;EAHnB,CA5BM,EAiCN;IACEJ,IAAI,EAAE,wBADR;IAEEC,IAAI,EAAE,kBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,8BAAP;EAHnB,CAjCM,EAsCN;IACEJ,IAAI,EAAE,SADR;IAEEC,IAAI,EAAE,SAFR;IAGEG,SAAS,EAAEnB;EAHb,CAtCM,EA2CN;IACEe,IAAI,EAAE,SADR;IAEEC,IAAI,EAAE,SAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,qBAAP;EAHnB,CA3CM,EAgDN;IACEJ,IAAI,EAAE,cADR;IAEEC,IAAI,EAAE,aAFR;IAGEG,SAAS,EAAEjB;EAHb,CAhDM,EAqDN;IACEa,IAAI,EAAE,oBADR;IAEEC,IAAI,EAAE,mBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,+BAAP;EAHnB,CArDM,EA0DN;IACEJ,IAAI,EAAE,kBADR;IAEEC,IAAI,EAAE,kBAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,6BAAP;EAHnB,CA1DM,EA+DN;IACEJ,IAAI,EAAE,kBADR;IAEEC,IAAI,EAAE,YAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,yBAAP;EAHnB,CA/DM,EAoEN;IACEJ,IAAI,EAAE,4BADR;IAEEC,IAAI,EAAE,WAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,kCAAP;EAHnB,CApEM,EAyEN;IACEJ,IAAI,EAAE,OADR;IAEEC,IAAI,EAAE,MAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,mBAAP;EAHnB,CAzEM,EA8EN;IACEJ,IAAI,EAAE,YADR;IAEEC,IAAI,EAAE,WAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,uBAAP;EAHnB,CA9EM,EAmFN;IACEJ,IAAI,EAAE,gBADR;IAEEC,IAAI,EAAE,WAFR;IAGEG,SAAS,EAAE,MAAM,OAAO,uBAAP;EAHnB,CAnFM,EAwFN;IACEJ,IAAI,EAAE,GADR;IAEEC,IAAI,EAAE,WAFR;IAGEG,SAAS,EAAElB;EAHb,CAxFM;AAFmB,CAAd,CAAf;AAkGAW,MAAM,CAACS,UAAP,CAAkB,OAAMf,EAAN,EAAUC,IAAV,EAAgBC,IAAhB,KAAyB;EACzC,MAAMc,mBAAmB,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA5B;EACA,MAAMC,YAAY,GAAGtB,KAAK,CAACO,KAAN,CAAYgB,KAAjC;EACA,IAAIC,eAAe,GAAGxB,KAAK,CAACO,KAAN,CAAYiB,eAAlC;;EAEA,IAAGL,mBAAmB,IAAIA,mBAAmB,KAAKG,YAAlD,EAAgE;IAC9DE,eAAe,GAAG,MAAMxB,KAAK,CAACyB,QAAN,CAAe,kBAAf,CAAxB;EACD;;EAED,MAAMC,0BAA0B,GAAG,CAAC,SAAD,EAAY,SAAZ,CAAnC;;EAEA,IAAI,CAACF,eAAD,IAAqB,CAACE,0BAA0B,CAACC,QAA3B,CAAoCxB,EAAE,CAACU,IAAvC,CAA1B,EAAwE;IACtER,IAAI,CAAC,SAAD,CAAJ;IACA;EACD;;EAED,IAAImB,eAAe,IAAKE,0BAA0B,CAACC,QAA3B,CAAoCxB,EAAE,CAACU,IAAvC,CAAxB,EAAsE;IACpER,IAAI,CAAC,cAAD,CAAJ;IACA;EACD;;EAEDA,IAAI;AACL,CAtBD;AAwBA,eAAeI,MAAf"},"metadata":{},"sourceType":"module"}