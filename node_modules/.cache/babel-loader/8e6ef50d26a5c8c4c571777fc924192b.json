{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport adminAPI from \"./../apis/admin\";\nimport { Toast } from \"./../utils/helpers\";\nexport default {\n  props: {\n    isProcessing: {\n      type: Boolean,\n      default: false\n    },\n    initialRestaurant: {\n      type: Object,\n      default: () => ({\n        name: \"\",\n        categoryId: \"\",\n        tel: \"\",\n        address: \"\",\n        description: \"\",\n        image: \"\",\n        openingHours: \"\"\n      })\n    }\n  },\n\n  data() {\n    return {\n      restaurant: { ...this.initialRestaurant\n      },\n      categories: [] // isLoading: true,\n\n    };\n  },\n\n  created() {\n    this.fetchCategories();\n    this.restaurant = { ...this.restaurant,\n      ...this.initialRestaurant\n    };\n  },\n\n  methods: {\n    async fetchCategories() {\n      try {\n        const {\n          data\n        } = await adminAPI.categories.get();\n\n        if (data.status !== \"success\") {\n          throw new Error(data.message);\n        }\n\n        console.log(data);\n        this.categories = data.categories;\n      } catch (error) {\n        console.error(error.message);\n        Toast.fire({\n          icon: \"error\",\n          title: \"無法取得餐廳類別，請稍後再試\"\n        });\n      }\n    },\n\n    handleFileChange(e) {\n      const files = e.target.files;\n\n      if (files.length === 0) {\n        this.restaurant.image = \"\";\n      } else {\n        const imageURL = window.URL.createObjectURL(files[0]);\n        this.restaurant.image = imageURL;\n      }\n    },\n\n    handleSubmit(e) {\n      if (!this.restaurant.name) {\n        Toast.fire({\n          icon: \"warning\",\n          title: \"請填寫餐廳名稱\"\n        });\n        return;\n      } else if (!this.restaurant.categoryId) {\n        Toast.fire({\n          icon: \"warning\",\n          title: \"請選擇餐廳類別\"\n        });\n        return;\n      }\n\n      const form = e.target;\n      const formData = new FormData(form);\n      this.$emit(\"after-submit\", formData);\n    }\n\n  }\n};","map":{"version":3,"mappings":";AA2GA;AACA;AAEA;EACAA;IACAC;MACAC,aADA;MAEAC;IAFA,CADA;IAKAC;MACAF,YADA;MAEAC;QACAE,QADA;QAEAC,cAFA;QAGAC,OAHA;QAIAC,WAJA;QAKAC,eALA;QAMAC,SANA;QAOAC;MAPA;IAFA;EALA,CADA;;EAmBAC;IACA;MACAC,cACA;MADA,CADA;MAIAC,cAJA,CAKA;;IALA;EAOA,CA3BA;;EA4BAC;IACA;IACA,oBACA,kBADA;MAEA;IAFA;EAIA,CAlCA;;EAmCAC;IACA;MACA;QACA;UAAAJ;QAAA;;QAEA;UACA;QACA;;QACAK;QAEA;MAEA,CAVA,CAUA;QACAA;QACAC;UACAC,aADA;UAEAC;QAFA;MAIA;IACA,CAnBA;;IAqBAC;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;QACA;MACA;IACA,CA7BA;;IA8BAC;MACA;QACAJ;UACAC,eADA;UAEAC;QAFA;QAIA;MACA,CANA,MAMA;QACAF;UACAC,eADA;UAEAC;QAFA;QAIA;MACA;;MACA;MACA;MACA;IACA;;EA/CA;AAnCA","names":["props","isProcessing","type","default","initialRestaurant","name","categoryId","tel","address","description","image","openingHours","data","restaurant","categories","created","methods","console","Toast","icon","title","handleFileChange","handleSubmit"],"sourceRoot":"src/components","sources":["AdminRestaurantForm.vue"],"sourcesContent":["<template>\r\n  <form v-show=\"!isLoading\" @submit.stop.prevent=\"handleSubmit\">\r\n    <div class=\"form-group\">\r\n      <label for=\"name\">Name</label>\r\n      <img\r\n        v-if=\"restaurant.image\"\r\n        :src=\"restaurant.image\"\r\n        class=\"d-block img-thumbnail mb-3\"\r\n        width=\"200\"\r\n        height=\"200\"\r\n      />\r\n      <input\r\n        id=\"name\"\r\n        v-model=\"restaurant.name\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        name=\"name\"\r\n        placeholder=\"Enter name\"\r\n        required\r\n      />\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"categoryId\">Category</label>\r\n      <select\r\n        id=\"categoryId\"\r\n        v-model=\"restaurant.categoryId\"\r\n        class=\"form-control\"\r\n        name=\"categoryId\"\r\n        required\r\n      >\r\n        <option value=\"\" selected disabled>--請選擇--</option>\r\n        <option\r\n          v-for=\"category in categories\"\r\n          :key=\"category.id\"\r\n          :value=\"category.id\"\r\n        >\r\n          {{ category.name }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"tel\">Tel</label>\r\n      <input\r\n        id=\"tel\"\r\n        v-model=\"restaurant.tel\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        name=\"tel\"\r\n        placeholder=\"Enter telephone number\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"address\">Address</label>\r\n      <input\r\n        id=\"address\"\r\n        v-model=\"restaurant.address\"\r\n        type=\"text\"\r\n        class=\"form-control\"\r\n        placeholder=\"Enter address\"\r\n        name=\"address\"\r\n        @change=\"handleFileChange\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"opening-hours\">Opening Hours</label>\r\n      <input\r\n        id=\"opening-hours\"\r\n        v-model=\"restaurant.openingHours\"\r\n        type=\"time\"\r\n        class=\"form-control\"\r\n        name=\"opening_hours\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"description\">Description</label>\r\n      <textarea\r\n        id=\"description\"\r\n        v-model=\"restaurant.description\"\r\n        class=\"form-control\"\r\n        rows=\"3\"\r\n        name=\"description\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"form-group\">\r\n      <label for=\"image\">Image</label>\r\n      <input\r\n        id=\"image\"\r\n        type=\"file\"\r\n        name=\"image\"\r\n        accept=\"image/*\"\r\n        class=\"form-control-file\"\r\n      />\r\n    </div>\r\n\r\n    <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"isProcessing\">\r\n      {{ isProcessing ? \"處理中...\" : \"送出\" }}\r\n    </button>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport adminAPI from \"./../apis/admin\";\r\nimport { Toast } from \"./../utils/helpers\";\r\n\r\nexport default {\r\n  props: {\r\n    isProcessing: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    initialRestaurant: {\r\n      type: Object,\r\n      default: () => ({\r\n        name: \"\",\r\n        categoryId: \"\",\r\n        tel: \"\",\r\n        address: \"\",\r\n        description: \"\",\r\n        image: \"\",\r\n        openingHours: \"\",\r\n      }),\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      restaurant: {\r\n        ...this.initialRestaurant\r\n      },\r\n      categories: [],\r\n      // isLoading: true,\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchCategories();\r\n    this.restaurant = {\r\n      ...this.restaurant,\r\n      ...this.initialRestaurant,\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchCategories() {      \r\n      try {\r\n        const { data } = await adminAPI.categories.get()\r\n\r\n        if (data.status !== \"success\") {\r\n          throw new Error(data.message);\r\n        }\r\n        console.log(data)\r\n\r\n        this.categories = data.categories;\r\n        \r\n      } catch (error) {  \r\n        console.error(error.message)      \r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法取得餐廳類別，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n\r\n    handleFileChange(e) {\r\n      const files = e.target.files;\r\n      if (files.length === 0) {\r\n        this.restaurant.image = \"\";\r\n      } else {\r\n        const imageURL = window.URL.createObjectURL(files[0]);\r\n        this.restaurant.image = imageURL;\r\n      }\r\n    },\r\n    handleSubmit(e) {\r\n      if (!this.restaurant.name) {\r\n        Toast.fire({\r\n          icon: \"warning\",\r\n          title: \"請填寫餐廳名稱\",\r\n        });\r\n        return;\r\n      } else if (!this.restaurant.categoryId) {\r\n        Toast.fire({\r\n          icon: \"warning\",\r\n          title: \"請選擇餐廳類別\",\r\n        });\r\n        return;\r\n      }\r\n      const form = e.target;\r\n      const formData = new FormData(form);\r\n      this.$emit(\"after-submit\", formData);\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}