{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport AdminRestaurantForm from \"./../components/AdminRestaurantForm.vue\";\nimport adminAPI from './../apis/admin';\nimport { Toast } from './../utils/helpers';\nexport default {\n  name: \"AdminRestaurantEdit\",\n  components: {\n    AdminRestaurantForm\n  },\n\n  data() {\n    return {\n      restaurant: {\n        id: -1,\n        name: \"\",\n        categoryId: \"\",\n        tel: \"\",\n        address: \"\",\n        description: \"\",\n        image: \"\",\n        openingHours: \"\"\n      },\n      isProcessing: false\n    };\n  },\n\n  created() {\n    const {\n      id\n    } = this.$route.params;\n    this.fetchRestaurant(id);\n    console.log(id);\n  },\n\n  beforeRouteUpdate(to, from, next) {\n    const {\n      id\n    } = to.params;\n    this.fetchRestaurant(id);\n  },\n\n  methods: {\n    async fetchRestaurant(restaurantId) {\n      try {\n        const {\n          data\n        } = await adminAPI.restaurants.getDetail({\n          restaurantId\n        });\n\n        if (data.status === 'error') {\n          throw new Error(data.message);\n        }\n\n        const {\n          id,\n          name,\n          tel,\n          address,\n          opening_hours: openingHours,\n          description,\n          image,\n          CategoryId: categoryId\n        } = data.restaurant;\n        this.restaurant = { ...this.restaurant,\n          id,\n          name,\n          tel,\n          address,\n          openingHours,\n          description,\n          image,\n          categoryId\n        };\n      } catch (error) {\n        console.error(error.message);\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得餐廳資料，請稍後再試'\n        });\n      }\n    },\n\n    async handleAfterSubmit(formData) {\n      try {\n        this.isProcessing = true;\n        const {\n          data\n        } = await adminAPI.restaurants.update({\n          restaurantId: this.restaurant.id,\n          formData\n        });\n\n        if (data.status !== 'success') {\n          throw new Error(data.message);\n        }\n\n        this.$router.push({\n          name: 'admin-restaurants'\n        });\n      } catch (error) {\n        this.isProcessing = false;\n        Toast.fire({\n          icon: 'error',\n          title: '無法更新餐廳資料，請稍後再試'\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";AAWA;AACA;AACA;AAEA;EACAA,2BADA;EAEAC;IACAC;EADA,CAFA;;EAKAC;IACA;MACAC;QACAC,MADA;QAEAL,QAFA;QAGAM,cAHA;QAIAC,OAJA;QAKAC,WALA;QAMAC,eANA;QAOAC,SAPA;QAQAC;MARA,CADA;MAWAC;IAXA;EAaA,CAnBA;;EAoBAC;IACA;MAAAR;IAAA;IACA;IACAS;EACA,CAxBA;;EAyBAC;IACA;MAAAV;IAAA;IACA;EACA,CA5BA;;EA6BAW;IACA;MACA;QACA;UAAAb;QAAA;UAAAc;QAAA;;QAEA;UACA;QACA;;QAEA;UACAZ,EADA;UAEAL,IAFA;UAGAO,GAHA;UAIAC,OAJA;UAKAU,2BALA;UAMAT,WANA;UAOAC,KAPA;UAQAS;QARA,IASAhB,eATA;QAWA,oBACA,kBADA;UAEAE,EAFA;UAGAL,IAHA;UAIAO,GAJA;UAKAC,OALA;UAMAG,YANA;UAOAF,WAPA;UAQAC,KARA;UASAJ;QATA;MAWA,CA7BA,CA6BA;QACAQ;QACAM;UACAC,aADA;UAEAC;QAFA;MAIA;IACA,CAtCA;;IAuCA;MACA;QACA;QACA;UAAAnB;QAAA;UACAc,gCADA;UAEAM;QAFA;;QAKA;UACA;QACA;;QAEA;UAAAvB;QAAA;MACA,CAZA,CAYA;QACA;QACAoB;UACAC,aADA;UAEAC;QAFA;MAIA;IACA;;EA3DA;AA7BA","names":["name","components","AdminRestaurantForm","data","restaurant","id","categoryId","tel","address","description","image","openingHours","isProcessing","created","console","beforeRouteUpdate","methods","restaurantId","opening_hours","CategoryId","Toast","icon","title","formData"],"sourceRoot":"src/views","sources":["AdminRestaurantEdit.vue"],"sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <AdminRestaurantForm\r\n      :initial-restaurant=\"restaurant\"\r\n      :is-processing=\"isProcessing\"\r\n      @after-submit=\"handleAfterSubmit\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AdminRestaurantForm from \"./../components/AdminRestaurantForm.vue\";\r\nimport adminAPI from './../apis/admin'\r\nimport { Toast } from './../utils/helpers'\r\n\r\nexport default {\r\n  name: \"AdminRestaurantEdit\",\r\n  components: {\r\n    AdminRestaurantForm,\r\n  },\r\n  data() {\r\n    return {\r\n      restaurant: {\r\n        id: -1,\r\n        name: \"\",\r\n        categoryId: \"\",\r\n        tel: \"\",\r\n        address: \"\",\r\n        description: \"\",\r\n        image: \"\",\r\n        openingHours: \"\",\r\n      },\r\n      isProcessing: false\r\n    };\r\n  },\r\n  created() {\r\n    const { id } = this.$route.params;\r\n    this.fetchRestaurant(id);\r\n    console.log(id)\r\n  },\r\n  beforeRouteUpdate(to,from,next){\r\n    const {id} = to.params\r\n    this.fetchRestaurant(id);\r\n  },\r\n  methods: {\r\n    async fetchRestaurant (restaurantId){\r\n      try {        \r\n        const { data } = await adminAPI.restaurants.getDetail({ restaurantId })\r\n\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }  \r\n\r\n        const {\r\n          id,\r\n          name,\r\n          tel,\r\n          address,\r\n          opening_hours: openingHours,\r\n          description,\r\n          image,\r\n          CategoryId: categoryId\r\n        } = data.restaurant\r\n        \r\n        this.restaurant = {\r\n          ...this.restaurant,\r\n          id,\r\n          name,\r\n          tel,\r\n          address,\r\n          openingHours,\r\n          description,\r\n          image,\r\n          categoryId\r\n        }\r\n      } catch (error) {\r\n        console.error(error.message)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得餐廳資料，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async handleAfterSubmit(formData) {\r\n      try {\r\n        this.isProcessing = true\r\n        const { data } = await adminAPI.restaurants.update({\r\n          restaurantId: this.restaurant.id,\r\n          formData\r\n        })\r\n\r\n        if (data.status !== 'success') {\r\n          throw new Error(data.message)\r\n        }\r\n\r\n        this.$router.push({ name: 'admin-restaurants' })\r\n      } catch (error) {\r\n        this.isProcessing = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法更新餐廳資料，請稍後再試'\r\n        })\r\n      }      \r\n    },    \r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}